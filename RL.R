library("dplyr")
library("ggpubr")
library("ggplot2")
library("reshape2")
data_path <- "C:\\Users\\amir0\\OneDrive\\Documents\\RL\\RL_chess\\data\\"
move_count_Q <- c(54.58, 51.752, 54.24, 52.379, 53.763, 55.423, 54.338, 57.498, 57.189, 56.523, 53.196, 55.22, 56.698, 59.075, 61.54, 58.127, 57.645, 61.03, 57.363, 58.621, 59.447, 59.633, 59.076, 58.62, 60.636, 59.422, 61.081, 61.27, 56.65, 58.866, 59.306, 60.324, 58.226, 55.476, 59.496, 58.456, 57.581, 55.41, 49.503, 50.491, 51.834, 53.873, 48.304, 48.308, 46.822, 47.869, 45.147, 44.087, 45.205, 40.158, 41.216, 40.596, 40.62, 38.156, 34.793, 35.014, 33.84, 33.141, 33.773, 31.548, 29.866, 29.261, 28.854, 26.15, 26.679, 26.757, 25.468, 24.189, 23.999, 24.425)
move_count_Random <- c(51.209, 53.216, 53.353, 53.097, 53.776, 53.056, 50.821, 55.808, 54.246, 54.02, 52.735, 50.119, 53.925, 51.996, 52.683, 52.557, 55.633, 52.575, 53.193, 56.294, 51.848, 53.919, 52.894, 55.496, 53.323, 54.552, 51.797, 52.32, 52.059, 52.998, 54.321, 50.814, 55.801, 54.255, 55.646, 52.367, 54.032, 52.479, 53.214, 54.004, 50.29, 52.5, 53.732, 54.156, 52.527, 50.953, 51.971, 52.881, 53.149, 52.904, 53.346, 53.448, 52.379, 53.44, 51.876, 55.199, 53.716, 54.75, 57.376, 51.107, 54.812, 51.71, 54.16, 53.291, 52.567, 54.862, 49.673, 53.834, 54.404, 53.943)
move_count_Sarsa <- c(52.53, 54.694, 53.472, 55.351, 54.112, 54.196, 54.851, 57.017, 56.002, 56.299, 55.893, 56.899, 57.879, 57.492, 56.356, 57.042, 58.411, 57.785, 58.696, 62.078, 59.611, 61.906, 58.042, 60.317, 58.628, 61.612, 61.378, 62.526, 58.98, 59.644, 57.75, 57.189, 57.372, 59.037, 60.225, 56.255, 53.67, 56.71, 56.968, 49.815, 52.072, 53.892, 46.852, 47.139, 46.755, 45.647, 46.934, 45.919, 42.817, 40.007, 41.649, 40.751, 39.473, 37.986, 37.36, 35.657, 34.213, 32.655, 30.037, 28.77, 27.615, 27.518, 29.399, 25.238, 25.048, 24.958, 23.347, 22.993, 24.152, 24.108)

no_move_count_Q <- c(58.066, 60.299, 66.849, 62.441, 68.588, 67.941, 71.768, 71.924, 73.34, 79.836, 75.892, 80.327, 82.923, 88.118, 58.792, 52.323, 52.528, 50.778, 53.258, 48.889, 49.113, 41.634, 49.078, 61.795, 57.126, 54.946, 44.778, 39.978, 38.786, 37.678, 39.529, 37.761, 40.658, 39.024, 37.491, 37.72, 37.44, 36.856, 36.812, 36.228, 34.951, 34.369, 35.41, 37.011, 34.683, 35.497, 35.925, 34.965, 35.867, 34.62, 32.294, 35.188, 34.187, 33.236, 33.288, 33.68, 33.02, 33.229, 33.985, 34.396, 32.595, 34.106, 35.008, 33.472, 33.186, 34.084, 32.62, 32.758, 32.881, 32.331)
no_move_count_Sarsa <- c(56.297, 60.815, 61.777, 66.607, 67.293, 68.955, 67.254, 68.14, 69.448, 68.947, 71.525, 74.564, 73.058, 67.928, 58.377, 65.6, 69.141, 50.306, 50.859, 52.365, 43.369, 42.77, 39.308, 40.072, 38.393, 37.259, 39.423, 38.387, 38.991, 39.349, 41.605, 40.51, 41.362, 40.427, 39.146, 38.482, 39.822, 39.141, 43.15, 38.855, 39.101, 35.685, 37.333, 36.686, 36.522, 36.239, 33.923, 36.357, 35.709, 37.066, 36.546, 37.396, 34.543, 35.574, 34.869, 36.094, 35.424, 34.978, 34.078, 34.276, 33.619, 35.995, 33.822, 34.049, 31.781, 32.469, 35.061, 34.543, 33.153, 34.474)


win_rate_Q <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.002, 0.0, 0.0, 0.0, 0.001, 0.001, 0.0, 0.0, 0.002, 0.0, 0.001, 0.002, 0.002, 0.002, 0.008, 0.007, 0.005, 0.012, 0.033, 0.023, 0.038, 0.073, 0.07, 0.086, 0.086, 0.143, 0.128, 0.141, 0.197, 0.212, 0.243, 0.28, 0.36, 0.326, 0.299, 0.407, 0.399, 0.423, 0.435, 0.485, 0.521, 0.495, 0.613, 0.587, 0.608, 0.631, 0.721, 0.727, 0.699, 0.78, 0.78, 0.782, 0.798, 0.842, 0.84, 0.834, 0.913, 0.913, 0.916, 0.94, 0.954, 0.952, 0.968)
win_rate_Random <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001, 0.0)
win_rate_Sarsa <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001, 0.0, 0.0, 0.0, 0.0, 0.001, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001, 0.006, 0.014, 0.013, 0.024, 0.035, 0.036, 0.034, 0.086, 0.066, 0.072, 0.104, 0.125, 0.117, 0.147, 0.188, 0.208, 0.198, 0.251, 0.322, 0.315, 0.304, 0.402, 0.41, 0.418, 0.478, 0.466, 0.512, 0.505, 0.565, 0.586, 0.592, 0.633, 0.697, 0.684, 0.685, 0.778, 0.751, 0.792, 0.833, 0.837, 0.851, 0.842, 0.894, 0.882, 0.888, 0.924, 0.936, 0.938, 0.93)

no_win_rate_Q <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.425, 0.545, 0.54, 0.634, 0.59, 0.584, 0.596, 0.65, 0.588, 0.431, 0.351, 0.549, 0.629, 0.748, 0.75, 0.762, 0.726, 0.745, 0.707, 0.753, 0.736, 0.766, 0.762, 0.775, 0.761, 0.783, 0.787, 0.791, 0.782, 0.776, 0.794, 0.772, 0.765, 0.772, 0.779, 0.797, 0.804, 0.805, 0.788, 0.81, 0.801, 0.807, 0.832, 0.827, 0.81, 0.809, 0.806, 0.816, 0.803, 0.821, 0.835, 0.812, 0.838, 0.815, 0.827, 0.848)
no_win_rate_Sarsa <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.005, 0.005, 0.007, 0.001, 0.103, 0.192, 0.34, 0.334, 0.538, 0.502, 0.621, 0.674, 0.681, 0.705, 0.689, 0.717, 0.719, 0.729, 0.719, 0.699, 0.709, 0.708, 0.706, 0.705, 0.717, 0.728, 0.725, 0.711, 0.752, 0.703, 0.74, 0.744, 0.766, 0.747, 0.77, 0.765, 0.765, 0.797, 0.772, 0.771, 0.782, 0.772, 0.794, 0.806, 0.779, 0.782, 0.785, 0.796, 0.797, 0.788, 0.794, 0.798, 0.778, 0.793, 0.822, 0.83, 0.832, 0.807, 0.803, 0.823, 0.807)

#Tests:
kruskal.test(move_count_Q,move_count_Random)
kruskal.test(move_count_Q,move_count_Sarsa)
kruskal.test(move_count_Sarsa,move_count_Random)

kruskal.test(win_rate_Q,win_rate_Random)
kruskal.test(win_rate_Q,win_rate_Sarsa)
kruskal.test(win_rate_Sarsa,win_rate_Random)
#Normality:
shapiro.test(move_count_Q)
shapiro.test(move_count_Random)
shapiro.test(move_count_Sarsa)
shapiro.test(win_rate_Q)
shapiro.test(win_rate_Random)
shapiro.test(win_rate_Sarsa)
#Log Normality:
shapiro.test(log(move_count_Q))
shapiro.test(log(move_count_Random))
shapiro.test(log(move_count_Sarsa))
shapiro.test(log(win_rate_Q))
shapiro.test(log(win_rate_Random))
shapiro.test(log(win_rate_SARSA))

Graphs:
  # Create data frames
data_move_counts <- data.frame(
    Episode = 1:length(move_count_Q),
    Q = move_count_Q,
    Sarsa = move_count_Sarsa
  )

data_win_rates <- data.frame(
  Episode = 1:length(win_rate_Q),
  Q = win_rate_Q,
  Sarsa = win_rate_Sarsa
)

# Melt data for plotting
data_move_counts_melted <- reshape2::melt(data_move_counts, id.vars = "Episode")
data_win_rates_melted <- reshape2::melt(data_win_rates, id.vars = "Episode")

# Plot move counts
p_move_counts <- ggplot(data_move_counts_melted, aes(x = Episode, y = value, color = variable)) +
  geom_line() +
  labs(title = "Move Count per Episode", x = "Episode", y = "Move Count", color = "Algorithm") +
  theme_minimal()

# Plot win rates
p_win_rates <- ggplot(data_win_rates_melted, aes(x = Episode, y = value, color = variable)) +
  geom_line() +
  labs(title = "Win Rate per Episode", x = "Episode", y = "Win Rate", color = "Algorithm") +
  theme_minimal()

# Display plots
p_move_counts
p_win_rates